<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Connexion | Tessy‚Äôs Beauty Academy</title>

  <link rel="stylesheet" href="/css/style.css">
  <script src="https://cdn.tailwindcss.com"></script>

  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

</head>

<body class="min-h-screen bg-gradient-to-b from-pink-100 to-white text-gray-800">

<!-- HEADER (unchanged) -->
<header class="fixed top-0 left-0 w-full bg-white/80 backdrop-blur-md shadow-sm z-50">
  <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
    <a href="/index.html" class="flex items-center space-x-2">
      <img src="https://i.ibb.co/ynmX90YW/1759790410129-removebg-preview.png" class="h-14 w-auto">
      <span class="text-pink-700 font-semibold text-xl">Tessy‚Äôs Beauty & More</span>
    </a>
  </div>
</header>

<main class="pt-28 px-4">

  <!-- LOGIN CARD -->
  <section class="max-w-md mx-auto bg-white shadow-md p-8 rounded-none">

    <h1 class="text-2xl font-bold text-pink-700 text-center mb-6">
      Connexion √âtudiant
    </h1>

    <p class="text-sm text-gray-600 text-center mb-8">
      Connectez-vous pour acc√©der √† vos cours et certificats.
    </p>

    <form id="loginForm" class="space-y-6">

      <!-- Email -->
      <div>
        <label class="block text-sm font-medium mb-1">Adresse email</label>
        <input
          type="email"
          id="email"
          required
          class="w-full px-4 py-2 border border-gray-300 focus:border-pink-600 focus:outline-none rounded-none"
          placeholder="exemple@email.com"
        >
      </div>

      <!-- Password -->
      <div>
        <label class="block text-sm font-medium mb-1">Mot de passe</label>
        <input
          type="password"
          id="password"
          required
          class="w-full px-4 py-2 border border-gray-300 focus:border-pink-600 focus:outline-none rounded-none"
          placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
        >
      </div>

      <!-- Status message -->
      <div id="statusMsg" class="hidden text-sm text-center"></div>

      <!-- Submit -->
      <button
        type="submit"
        class="w-full py-3 bg-pink-600 text-white font-medium hover:bg-pink-700 transition rounded-none">
        üîê Se connecter
      </button>

    </form>

    <!-- Links -->
    <div class="text-center mt-6 text-sm">
      <p>
        Pas encore inscrit ?
        <a href="/formulaire.html" class="text-pink-600 font-medium hover:underline">
          Cr√©er un compte
        </a>
      </p>
    </div>

  </section>

</main>

<!-- FOOTER (unchanged) -->
<footer class="bg-pink-600 text-white text-center py-6 px-4 mt-20">
  <p class="text-sm">¬© 2025 Tessy‚Äôs Beauty & More</p>
</footer>

<!-- LOGIN SCRIPT -->
<script>
document.getElementById("loginForm").addEventListener("submit", async function(e) {
  e.preventDefault();

  const status = document.getElementById("statusMsg");
  status.className = "text-sm text-center text-gray-600";
  status.textContent = "Connexion en cours...";
  status.classList.remove("hidden");

  const payload = {
    email: document.getElementById("email").value,
    password: document.getElementById("password").value
  };

  try {
    const res = await fetch("/api/auth", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    const data = await res.json();

    if (!res.ok) {
      status.className = "text-sm text-center text-red-600";
      status.textContent = data.message || "Erreur de connexion";
      return;
    }

    if (data.status === "pending") {
      status.className = "text-sm text-center text-yellow-600";
      status.textContent = "Paiement en attente de validation.";
      return;
    }

    // Save token (later switch to cookie)
    localStorage.setItem("academy_token", data.token);

    window.location.href = "/courses/dashboard.html";

  } catch (err) {
    status.className = "text-sm text-center text-red-600";
    status.textContent = "Erreur r√©seau.";
  }
});
</script>

</body>
</html>
